# 欧拉

https://gitee.com/src-openeuler/openEuler-repos/raw/openEuler-20.03-LTS/generic.repo


# 选型方案
ambari
cdh
bigtop
自编译apache 手动维护大数据组件
手动编译byzer镜像

# 配置如下

# 操作系统
国产操作系统欧拉20.3
https://www.openeuler.org/zh/download/

#内存
每台机器64G及以上

# 硬盘
500G

# cpu
16-32核


# spark standalone 集群模式部署

https://taoistwar.gitbooks.io/spark-operationand-maintenance-management/content/spark_install/spark_standalone_with_filesystem_ha.html

https://cloud.tencent.com/developer/article/1964177


## spark standalone 流程

https://gist.github.com/baymaxium/9a525e160986a022f9143516fa6585bc

## spark standalone

spark standalone


standalone高可用HA模式
spark官方给出了2种解决方法，
- 一个是使用zk做分布式协调，zk选主;
- 另一个是使用基于LOCAL FILE SYSTEM恢复的单节点方案。第二种其实只有1个master实例，当master故障后服务不可用，必须重启master进程，一般在生成系统上是不可接受的，所以我采用的是第一种方式。

https://www.cnblogs.com/jpSpaceX/articles/15007922.html

https://ieevee.com/tech/2016/04/05/spark-standalone.html

https://colobu.com/2014/12/09/spark-standalone-mode/

## log4j配置

https://w3sun.com/536.html

日志按天切分
```sh
log4j.rootCategory=INFO,  FILE
 log4j.appender.FILE.Threshold=info
 log4j.appender.FILE.file=/$PATH/${app.logging.name}-driver.log
 log4j.appender.FILE.DatePattern='.'yyyy-MM-dd
 log4j.appender.FILE.layout=org.apache.log4j.PatternLayout
 log4j.appender.FILE.layout.ConversionPattern=[%p] %d %c %M - %m%n
```
https://codeantenna.com/a/s2kVulZCNJ

http://ileaf.tech/bigdata/2018/05/21/spark%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9/

## spark history server 配置非hdfs模式的目录配置

spark-defaults.conf
```sh
mkdir -p /data/logs/spark-events

spark.eventLog.enabled          true
spark.eventLog.dir              file:/data/spark-events
spark.history.fs.logDirectory   file:/data/spark-events
```

https://stackoverflow.com/questions/44835026/how-to-enable-spark-history-server-for-standalone-cluster-non-hdfs-mode


```sh
/data/dep/byzer-build/dev/lib/spark-3.1.1-bin-hadoop3.2/sbin/workers.sh:100:  SPARK_SSH_OPTS="-P1212 -o StrictHostKeyChecking=no"

scp -P1212 -r /data/dep/byzer-build/dev/lib/spark-3.1.1-bin-hadoop3.2/sbin/workers.sh root@cdh03.com:/data/dep/byzer-build/dev/lib/spark-3.1.1-bin-hadoop3.2/sbin/workers.sh
```

```sh
start-all.sh
start-history-server.sh
```

## spark monitor

https://spark.apache.org/docs/latest/monitoring.html

## spark history server

https://blog.csdn.net/littlePYR/article/details/104621255




# zookeeper
https://github.com/qiurunze123/zookeeperDesign

https://github.com/llohellohe/zookeeper


# 欧拉 ai bigdata
https://mailweb.openeuler.org/hyperkitty/list/sig-ai-bigdata@openeuler.org/

https://mailweb.openeuler.org/hyperkitty/list/sig-ai-bigdata@openeuler.org/thread/JTISG3TB4SYAYOYRA3SB7RF44V5LKYYY/

# 欧拉兼容性配置
https://ic-openlabs.huawei.com/client/#/unioncompaty

https://mailweb.openeuler.org/hyperkitty/list/sig-ai-bigdata@openeuler.org/thread/6ZFVXKJABTDYOOSLPRLFZJ5U7VNNVXZ7/

https://gitcode.net/openeuler/community/-/blob/3b0c55b1721aad63123150a87c3fd79f35261a13/sig/sig-ai-bigdata/README.md?from_codechina=yes


# 欧拉发版
https://tehub.com/a/8zVhVIyPqn

https://www.hikunpeng.com/developer/openEuler


# ambari

https://docs.cloudera.com/HDPDocuments/HDP3/HDP-3.1.5/installation.html



# bigtop

bigtop 3.1.1 stack includes the following components
        alluxio                        2.4.1
        ambari                         2.7.5
        bigtop-ambari-mpack            2.7.5
        bigtop-groovy                  2.5.4
        bigtop-jsvc                    1.2.4
        bigtop-utils                   3.1.1
        elasticsearch                 5.6.14
        flink                         1.11.6
        gpdb                          5.28.5
        hadoop                         3.2.4
        hbase                         2.4.11
        hive                           3.1.2
        kafka                          2.8.1
        kibana                         5.4.1
        livy                           0.7.1
        logstash                       5.4.1
        oozie                          5.2.1
        phoenix                        5.1.2
        solr                          8.11.1
        spark                          3.1.2
        sqoop                          1.4.7
        tez                           0.10.1
        ycsb                          0.17.0
        zeppelin                      0.10.0
        zookeeper                      3.5.9

https://cwiki.apache.org/confluence/display/BIGTOP/Overview+of+Bigtop+3.1.1+Support+Matrix

https://cwiki.apache.org/confluence/display/BIGTOP/Bigtop+3.1.1+Release


https://ambari.apache.org/

https://archive.apache.org/dist/ambari/ambari-2.7.5/

https://www.baifachuan.com/posts/1877d8de.html

## ambari 安装记录

https://lvbibir.cn/archives/702


https://www.cnblogs.com/seven0007/p/ambari.html


https://mp.weixin.qq.com/s/ZUvVv3cG4MIK1oYY3LX4Yg

https://mp.weixin.qq.com/s/43ByDO46Lw4vdE9H-kOc2w



http://www.erik-ly.com/2020/12/03/ambari-install/
